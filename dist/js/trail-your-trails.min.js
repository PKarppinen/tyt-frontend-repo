/*! trail-your-trails.min.js 31-01-2022 */

angular.module("trail-your-trails",["ngRoute","login-controller","list-all-trails-controller","navigation-controller","add-new-trail-controller","update-trail-controller","delete-trail-controller","update-trail-directive","show-iframe-directive","trail-iframe-filter","tyt-config"]).config(["$httpProvider",function($httpProvider){$httpProvider.defaults.withCredentials=!0}]),angular.module("tyt-config",[]).constant("tytConfig",{apiUrl:"https://localhost:8443"}),angular.module("add-new-trail-controller",[]).controller("AddNewTrailController",["$scope","$http","tytConfig",function($scope,$http,config){$scope.trail={},$scope.successfulAdd=!1,$scope.addNewTrail=function(trail){$scope.errors=null,$http({method:"POST",url:config.apiUrl+"/api/trails/",data:trail,withCredentials:!1}).success(function(data){$scope.successfulAdd=!0}).catch(function(trail){$scope.errors=trail.data.error}),$scope.trail={}}}]),angular.module("delete-trail-controller",[]).controller("DeleteTrailController",["$scope","$http","tytConfig",function($scope,$http,config){$scope.trails=[],$scope.successfulDelete=!1,$scope.trailIdToBeDeleted={id:""},$http({method:"GET",url:config.apiUrl+"/api/trails/",withCredentials:!1}).success(function(data){$scope.trails=data}),$scope.deleteTrails=function(){$scope.errors=null,""!==$scope.trailIdToBeDeleted&&$http({method:"DELETE",url:config.apiUrl+"/api/trails/"+$scope.trailIdToBeDeleted.id,withCredentials:!1}).success(function(data){$scope.successfulDelete=!0,$scope.trailIdToBeDeleted.id=""}).catch(function(trail){$scope.errors=trail.data.error})}}]),angular.module("list-all-trails-controller",[]).controller("ListAllTrailsController",["$scope","$http","tytConfig",function($scope,$http,config){$scope.trails=[],$http({method:"GET",url:config.apiUrl+"/api/trails/",withCredentials:!1}).success(function(data){$scope.trails=data})}]),angular.module("login-controller",[]).controller("LoginController",["$scope","$window","$location","$http","tytConfig",function($scope,$window,$location,$http,config){$scope.creds={},$scope.successfulLogin=!1,$scope.login=function(creds){$scope.errors=null;var credentials="username="+creds.username+"&password="+creds.password;$http({method:"POST",url:config.apiUrl+"/login",data:credentials,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(userData){var token;userData.data?(token=$window.btoa(creds.username+":"+creds.password),userData={username:creds.username,authData:token},$window.sessionStorage.setItem("userData",JSON.stringify(userData)),$http.defaults.headers.common.Authorization="Basic "+token,$location.path("/list-all-trails")):alert("Authentication failed.")})}}]),angular.module("navigation-controller",[]).controller("NavigationController",["$scope","$location",function($scope,page){page=page.path(),page=page.substring(page.lastIndexOf("/")+1);$scope.tab=""!==page?page:"list-all-trails",$scope.selectTab=function(setTab){$scope.tab=setTab},$scope.isSelected=function(checkTab){return $scope.tab===checkTab}}]),angular.module("update-trail-controller",[]).controller("UpdateTrailController",["$scope","$http","tytConfig",function($scope,$http,config){$scope.trails=[],$scope.successfulUpdate=!1,$scope.trailToBeUpdated={},$http({method:"GET",url:config.apiUrl+"/api/trails/",withCredentials:!1}).success(function(data){$scope.trails=data}),$scope.trailSelected=function(trail){$scope.trailToBeUpdated=trail,console.log("Trail id to be updated: "+trail.id)},$scope.updateTrail=function(trail){$scope.errors=null,$http({method:"PUT",url:config.apiUrl+"/api/trails/",data:trail,withCredentials:!1}).success(function(data){$scope.successfulUpdate=!0}).catch(function(trail){$scope.errors=trail.data.error}),$scope.trailToBeUpdated={}}}]),angular.module("show-iframe-directive",[]).directive("showIframe",function(){return{restrict:"E",templateUrl:"templates/show_iframe.html"}}),angular.module("update-trail-directive",[]).directive("updateTrail",function(){return{restrict:"E",templateUrl:"templates/update_trail_details.html"}}),angular.module("trail-iframe-filter",[]).filter("trust_iframe",["$sce",function($sce){return function(text){return $sce.trustAsHtml(text)}}]),angular.module("trail-your-trails").config(function($routeProvider){$routeProvider.when("/",{templateUrl:"templates/login.html",controller:"LoginController"}).when("/list-all-trails",{templateUrl:"templates/list_all_trails.html",controller:"ListAllTrailsController"}).when("/add-new-trail",{templateUrl:"templates/add_new_trail.html",controller:"AddNewTrailController"}).when("/update-trail",{templateUrl:"templates/update_trail.html",controller:"UpdateTrailController"}).when("/delete-trail",{templateUrl:"templates/delete_trail.html",controller:"DeleteTrailController"}).otherwise({redirectTo:"/"})});